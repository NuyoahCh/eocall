# EOCall - OnCall æ™ºèƒ½å“åº”å¼•æ“

[![Go Version](https://img.shields.io/badge/Go-1.24-blue.svg)](https://golang.org)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Framework](https://img.shields.io/badge/Framework-GoFrame-orange.svg)](https://goframe.org)

åŸºäº Go è¯­è¨€å¼€å‘çš„æ™ºèƒ½ OnCall å“åº”å¼•æ“ï¼Œé›†æˆçŸ¥è¯†åº“æ£€ç´¢ã€AI å¯¹è¯ä¸è‡ªåŠ¨åŒ–è¿ç»´èƒ½åŠ›ï¼Œé€šè¿‡ ReAct Agent å®ç°æ•…éšœç§’çº§åº”ç­”ã€æ ¹å› åˆ†æä¸æ™ºèƒ½å†³ç­–ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ¤– **AI Agent å¼•æ“**ï¼šåŸºäº ReAct æ¨¡å¼çš„å¤šæ­¥éª¤æ¨ç†ï¼Œæ”¯æŒå·¥å…·è°ƒç”¨ä¸ä¸Šä¸‹æ–‡è®°å¿†
- ğŸ“š **çŸ¥è¯†åº“å¢å¼º**ï¼šRAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯ï¼Œç»“åˆ Milvus å‘é‡åº“å®ç°ç²¾å‡†æ–‡æ¡£æ£€ç´¢
- âš¡ **æµå¼å“åº”**ï¼šæ”¯æŒ SSE å®æ—¶æ¨é€ Agent æ¨ç†è¿‡ç¨‹ï¼Œç§’çº§äº¤äº’ä½“éªŒ
- ğŸ”§ **å·¥å…·ç”Ÿæ€**ï¼šå†…ç½® MySQL æŸ¥è¯¢ã€æ—¥å¿—æ£€ç´¢ã€Prometheus å‘Šè­¦ã€MCP åè®®å·¥å…·
- ğŸš€ **å¼€ç®±å³ç”¨**ï¼šDocker Compose ä¸€é”®éƒ¨ç½²ï¼Œå®Œæ•´çš„ Swagger API æ–‡æ¡£

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          GoFrame Web æ¡†æ¶ (HTTP æœåŠ¡)            â”‚
â”‚  CORS ä¸­é—´ä»¶ | å“åº”æ ¼å¼åŒ– | é”™è¯¯å¤„ç†               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Chat Controller (API è·¯ç”±å±‚)              â”‚
â”‚  â”œâ”€ /api/chat           (åŒæ­¥å¯¹è¯)               â”‚
â”‚  â”œâ”€ /api/chat_stream    (æµå¼å¯¹è¯)               â”‚
â”‚  â”œâ”€ /api/upload         (çŸ¥è¯†åº“å¯¼å…¥)             â”‚
â”‚  â””â”€ /api/ai_ops         (AI è¿ç»´æ“ä½œ)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Chat Pipeline (Eino Compose Graph)          â”‚
â”‚                                                   â”‚
â”‚  START â”€â”€â†’ InputToRag â”€â”€â”                         â”‚
â”‚      â””â”€â”€â†’ InputToChat â”€â”€â”¼â”€â”€â†’ ChatTemplate         â”‚
â”‚           MilvusRetriever â†‘                       â”‚
â”‚                            â”‚                      â”‚
â”‚                        ReactAgent â”€â”€â†’ END         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         AI Models & Tools                        â”‚
â”‚  â”œâ”€ DeepSeek V3 (æ€è€ƒ/å¿«é€Ÿæ¨¡å‹)                    â”‚
â”‚  â”œâ”€ Doubao Embedding                             â”‚
â”‚  â”œâ”€ Tool è°ƒç”¨æ¡†æ¶                                 â”‚
â”‚  â””â”€ MCP å·¥å…·é›†æˆ                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        æ•°æ®å­˜å‚¨ & å¤–éƒ¨æœåŠ¡                        â”‚
â”‚  â”œâ”€ Milvus (å‘é‡æ•°æ®åº“)                          â”‚
â”‚  â”œâ”€ MySQL (å…³ç³»æ•°æ®åº“)                           â”‚
â”‚  â”œâ”€ Prometheus (æŒ‡æ ‡å‘Šè­¦)                        â”‚
â”‚  â””â”€ MCP æœåŠ¡å™¨ (æ—¥å¿—ç­‰)                           â”‚ 
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ æ ¸å¿ƒç»„ä»¶

### AI å¯¹è¯ä¸ Agent ç³»ç»Ÿ
- **Chat Pipeline**ï¼šåŸºäº Eino æ¡†æ¶çš„ ReAct Agentï¼Œæ”¯æŒæœ€å¤š 25 æ­¥æ¨ç†
- **è®°å¿†ç®¡ç†**ï¼šåŸºäºç”¨æˆ· ID çš„ä¼šè¯å†å²å­˜å‚¨
- **æµå¼æ¨ç†**ï¼šå®æ—¶å±•ç¤º Agent æ€è€ƒä¸å·¥å…·è°ƒç”¨è¿‡ç¨‹

### çŸ¥è¯†åº“ç®¡ç†
- **æ–‡æ¡£å¤„ç†**ï¼šæ”¯æŒ Markdown æ–‡æ¡£åˆ†å‰²ä¸ç´¢å¼•
- **å‘é‡æ£€ç´¢**ï¼šDoubao Embedding + Milvus å‘é‡æ•°æ®åº“
- **RAG å¢å¼º**ï¼šä¸Šä¸‹æ–‡èåˆç”Ÿæˆï¼Œæå‡å›ç­”å‡†ç¡®æ€§

### å·¥å…·ç³»ç»Ÿ
| å·¥å…· | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **MySQL CRUD** | æ•°æ®åº“æ“ä½œ | æŸ¥è¯¢ä¸ä¿®æ”¹ä¸šåŠ¡æ•°æ® |
| **å†…éƒ¨æ–‡æ¡£æŸ¥è¯¢** | çŸ¥è¯†åº“æ£€ç´¢ | RAG æ–‡æ¡£æ£€ç´¢ |
| **æ—¥å¿—æŸ¥è¯¢** | MCP åè®®æ—¥å¿—å·¥å…· | æŸ¥è¯¢ç³»ç»Ÿæ—¥å¿— |
| **æŒ‡æ ‡å‘Šè­¦** | Prometheus å‘Šè­¦ | æŸ¥è¯¢å®æ—¶å‘Šè­¦ä¿¡æ¯ |
| **æ—¶é—´å·¥å…·** | è·å–å½“å‰æ—¶é—´ | æä¾›æ—¶é—´ä¸Šä¸‹æ–‡ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Go 1.24+
- Docker & Docker Compose
- MySQL 8.0+

### 1ï¸âƒ£ å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/NuyoahCh/eocall.git
cd eocall
```

### 2ï¸âƒ£ å¯åŠ¨åŸºç¡€æœåŠ¡
ä½¿ç”¨ Docker Compose å¯åŠ¨ Milvus å‘é‡æ•°æ®åº“åŠä¾èµ–æœåŠ¡ï¼š

```bash
cd manifest/docker
docker-compose up -d
```

æœåŠ¡åŒ…æ‹¬ï¼š
- **Milvus**ï¼šå‘é‡æ•°æ®åº“æ ¸å¿ƒæœåŠ¡
- **etcd**ï¼šåˆ†å¸ƒå¼é…ç½®åè°ƒ
- **MinIO**ï¼šå¯¹è±¡å­˜å‚¨ï¼ˆMilvus ä¾èµ–ï¼‰
- **Attu**ï¼šMilvus å¯è§†åŒ–ç®¡ç†ç•Œé¢ï¼ˆhttp://localhost:8000ï¼‰

### 3ï¸âƒ£ é…ç½®æ–‡ä»¶
ç¼–è¾‘ `manifest/config/config.yaml`ï¼š

```yaml
server:
  address: ":6872"

# LLM æ¨¡å‹é…ç½®
ds_think_chat_model:
  api_key: "your-api-key"
  base_url: "https://ark.cn-beijing.volces.com/api/v3"
  model: "deepseek-v3-1-terminus"

ds_quick_chat_model:
  api_key: "your-api-key"
  model: "deepseek-v3-1-terminus"

# Embedding æ¨¡å‹
doubao_embedding_model:
  api_key: "your-api-key"
  model: "doubao-embedding-text-240715"

# çŸ¥è¯†åº“æ–‡æ¡£ç›®å½•
file_dir: "./docs"
```

### 4ï¸âƒ£ å¯åŠ¨åº”ç”¨
```bash
go mod tidy
go run main.go
```

åº”ç”¨å°†åœ¨ `http://localhost:6872` å¯åŠ¨ã€‚

### 5ï¸âƒ£ ä¸Šä¼ çŸ¥è¯†åº“æ–‡æ¡£
```bash
curl -X POST http://localhost:6872/api/upload \
  -F "file=@your-document.md"
```

### 6ï¸âƒ£ å¼€å§‹å¯¹è¯
**åŒæ­¥å¯¹è¯**ï¼š
```bash
curl -X POST http://localhost:6872/api/chat \
  -H "Content-Type: application/json" \
  -d '{
    "query": "å¦‚ä½•æ’æŸ¥æ•°æ®åº“è¿æ¥å¤±è´¥é—®é¢˜ï¼Ÿ",
    "user_id": "user123"
  }'
```

**æµå¼å¯¹è¯**ï¼š
```bash
curl -X POST http://localhost:6872/api/chat_stream \
  -H "Content-Type: application/json" \
  -d '{
    "query": "æŸ¥è¯¢æœ€è¿‘çš„å‘Šè­¦ä¿¡æ¯",
    "user_id": "user123"
  }'
```

## ğŸ“š API æ–‡æ¡£

| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/chat` | POST | åŒæ­¥å¯¹è¯æ¥å£ |
| `/api/chat_stream` | POST | æµå¼å¯¹è¯æ¥å£ï¼ˆSSEï¼‰ |
| `/api/upload` | POST | ä¸Šä¼ çŸ¥è¯†åº“æ–‡æ¡£ |
| `/api/ai_ops` | POST | AI è¿ç»´æ“ä½œ |

### è¯·æ±‚ç¤ºä¾‹

**ChatReq**:
```json
{
  "query": "ç”¨æˆ·æé—®å†…å®¹",
  "user_id": "å”¯ä¸€ç”¨æˆ·æ ‡è¯†"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "answer": "AI å›ç­”å†…å®¹",
    "session_id": "ä¼šè¯ID"
  }
}
```

## ğŸ› ï¸ é¡¹ç›®ç»“æ„

```
eocall/
â”œâ”€â”€ api/                    # API æ¥å£å®šä¹‰
â”‚   â””â”€â”€ chat/              # èŠå¤©ç›¸å…³æ¥å£
â”œâ”€â”€ internal/              # å†…éƒ¨å®ç°
â”‚   â”œâ”€â”€ ai/               # AI å¼•æ“æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ agent/       # Agent æµç¨‹ç¼–æ’
â”‚   â”‚   â””â”€â”€ tools/       # å·¥å…·é›†åˆ
â”‚   â”œâ”€â”€ consts/          # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ controller/      # æ§åˆ¶å™¨å±‚
â”‚   â””â”€â”€ logic/           # ä¸šåŠ¡é€»è¾‘å±‚
â”œâ”€â”€ manifest/             # é…ç½®ä¸éƒ¨ç½²
â”‚   â”œâ”€â”€ config/          # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ docker/          # Docker ç¼–æ’
â”œâ”€â”€ utility/              # å·¥å…·åº“
â”‚   â”œâ”€â”€ common/          # å…¬å…±å·¥å…·
â”‚   â””â”€â”€ middleware/      # ä¸­é—´ä»¶
â”œâ”€â”€ web/                  # å‰ç«¯èµ„æº
â”œâ”€â”€ main.go              # åº”ç”¨å…¥å£
â”œâ”€â”€ go.mod               # Go æ¨¡å—ä¾èµ–
â””â”€â”€ README.md            # é¡¹ç›®æ–‡æ¡£
```

## ğŸ”§ æ ¸å¿ƒä¾èµ–

| ç»„ä»¶ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| [Eino](https://github.com/cloudwego/eino) | v0.7.14 | AI Agent ç¼–æ’æ¡†æ¶ |
| [GoFrame](https://goframe.org) | v2.7.1 | Web åº”ç”¨æ¡†æ¶ |
| [Milvus SDK](https://milvus.io) | v2.4.2 | å‘é‡æ•°æ®åº“å®¢æˆ·ç«¯ |
| [GORM](https://gorm.io) | v1.31.0 | MySQL ORM æ¡†æ¶ |
| [MCP Go](https://github.com/mark3labs/mcp-go) | v0.42.0 | MCP åè®®å·¥å…·é›†æˆ |

## ğŸ“ å¼€å‘æŒ‡å—

### æ·»åŠ è‡ªå®šä¹‰å·¥å…·

åœ¨ `internal/ai/tools/` ç›®å½•ä¸‹åˆ›å»ºæ–°å·¥å…·ï¼š

```go
package tools

import "github.com/cloudwego/eino/components/tool"

func NewCustomTool() tool.InvokableTool {
    return tool.InvokableTool{
        Desc: &tool.ToolInfo{
            Name: "custom_tool",
            Desc: "å·¥å…·æè¿°",
        },
        ParamSchema: /* JSON Schema */,
        InvokeFn: func(ctx context.Context, params string) (string, error) {
            // å·¥å…·æ‰§è¡Œé€»è¾‘
            return "result", nil
        },
    }
}
```

### æ‰©å±•çŸ¥è¯†åº“

å°† Markdown æ–‡æ¡£æ”¾å…¥é…ç½®çš„ `file_dir` ç›®å½•ï¼Œé€šè¿‡ `/api/upload` æ¥å£ä¸Šä¼ ï¼š

```bash
curl -X POST http://localhost:6872/api/upload \
  -F "file=@runbook.md"
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ License

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ï¼Œè¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

- [CloudWeGo Eino](https://github.com/cloudwego/eino) - AI Agent ç¼–æ’æ¡†æ¶
- [GoFrame](https://goframe.org) - ä¼˜ç§€çš„ Go åº”ç”¨æ¡†æ¶
- [Milvus](https://milvus.io) - å¼ºå¤§çš„å‘é‡æ•°æ®åº“

## ğŸ“§ è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€ï¼šhttps://github.com/NuyoahCh/eocall
- é—®é¢˜åé¦ˆï¼š[Issues](https://github.com/NuyoahCh/eocall/issues)
